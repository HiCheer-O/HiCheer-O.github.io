import{_ as s,c as i,o as a,a as t}from"./app-Y7YybkpV.js";const n="/assets/image-20240912124035454-DsmPLmDL.png",e="/assets/image-20240912133906460-C35OSY09.png",h="/assets/image-20240912133954183-Bs2MxeVJ.png",l="/assets/image-20240912134048898--ZU-1Ubl.png",p="/assets/image-20240912134131659-Yoy5nz2M.png",k="/assets/image-20240912134701771-CFTwmOlD.png",d="/assets/image-20240912134753525-Cu7DUlMC.png",c="/assets/image-20240912134903895-Ch7y61ZC.png",r={},o=t('<h3 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h3><blockquote><p>本次安装使用的是 <code>Docker</code>与<code>docker-compose</code>，相对于传统的二进制文件安装相比，不需要关心复杂的服务器环境，只需要在服务器上安装 <code>Docker</code>即可；使用 <code>Docker</code>的时候我们只关注数据的持久化和<code>Docker容器</code>与<code>宿主机</code>的端口映射即可，其中数据持久化包括 <code>conf</code>、<code>log</code>、<code>项目路径地址</code>等。</p></blockquote><h3 id="基础环境" tabindex="-1"><a class="header-anchor" href="#基础环境"><span>基础环境</span></a></h3><table><thead><tr><th>名称</th><th>版本</th></tr></thead><tbody><tr><td>服务器及操作系统</td><td>Linux、Centos 7</td></tr><tr><td>Docker</td><td>Docker version 26.1.3</td></tr><tr><td>Docker Compose</td><td>Docker Compose version v2.27.1</td></tr></tbody></table><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h3><ol><li><p>创建 nginx 文件夹及进入nginx 文件夹</p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;&amp;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx</span></span></code></pre></div><p><img src="'+n+`" alt="image-20240912124035454" width="1620" height="142"></p></li><li><p>将容器内的外挂文件复制出来</p><p>编写不含有外挂卷的<code>docker-compose.yml</code></p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker-compose.yml</span></span></code></pre></div><div class="language-yml" data-ext="yml" data-title="yml"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">version</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">3.7</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">services</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  nginx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                             # 镜像名称    </span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> base-nginx</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                      # 容器名称    </span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> always</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                 # 自动重启    </span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    ports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                          # 端口映射：宿主机端口:容器内部端口</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">80:80</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">443:443</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div><p><img src="`+e+'" alt="image-20240912133906460" width="2140" height="502"></p><p>启动 nginx</p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker-compose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span></span></code></pre></div><p><img src="'+h+`" alt="image-20240912133954183" width="3586" height="772"></p><p>将容器内外挂卷复制出来</p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> base-nginx:/etc/nginx/nginx.conf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> base-nginx:/etc/nginx/conf.d</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/conf.d</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> base-nginx:/usr/share/nginx/html</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/html</span></span></code></pre></div><p><img src="`+l+'" alt="image-20240912134048898" width="2018" height="382"></p><p>关闭 nginx</p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker-compose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> down</span></span></code></pre></div><p><img src="'+p+`" alt="image-20240912134131659" width="2320" height="254"></p></li><li><p>启动 Nginx</p><p>修改<code>docker-compose.yml</code></p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker-compose.yml</span></span></code></pre></div><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">version:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">3.7</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">services:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  nginx:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                             # 镜像名称    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    container_name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> base-nginx</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                      # 容器名称    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    restart:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> always</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                 # 自动重启    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    volumes:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                        # 外挂数据卷    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/nginx.conf:/etc/nginx/nginx.conf</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 主配置文件    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/conf.d:/etc/nginx/conf.d</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">         # 副配置文件       </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/html:/usr/share/nginx/html</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">       # 默认页面（首页、404、50X等）      </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/logs:/var/log/nginx</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">              # 日志     </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /opt/nginx/projects/:/home/projects/</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # 项目地址    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    ports:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                          # 端口映射：宿主机端口:容器内部端口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">80:80</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">443:443</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div><p><img src="`+k+'" alt="image-20240912134701771" width="2094" height="724"></p><p>启动</p><div class="language-bash" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker-compose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> up</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span></span></code></pre></div><p><img src="'+d+'" alt="image-20240912134753525" width="3534" height="478"></p></li></ol><h3 id="测试" tabindex="-1"><a class="header-anchor" href="#测试"><span>测试</span></a></h3><ol><li><p>访问</p><div class="language-http" data-ext="http" data-title="http"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">http://ip:80</span></span></code></pre></div><p><img src="'+c+'" alt="image-20240912134903895" width="3598" height="1018"></p></li></ol>',8),g=[o];function A(y,m){return a(),i("div",null,g)}const u=s(r,[["render",A],["__file","index.html.vue"]]),v=JSON.parse(`{"path":"/article/wunwnwy4/","title":"Nginx 安装及配置","lang":"zh-CN","frontmatter":{"title":"Nginx 安装及配置","author":"HiCheer","createTime":"2024/09/12 11:20:44","permalink":"/article/wunwnwy4/","tags":["运维","Docker","Nginx"],"head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":3,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":3,"title":"基础环境","slug":"基础环境","link":"#基础环境","children":[]},{"level":3,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":3,"title":"测试","slug":"测试","link":"#测试","children":[]}],"readingTime":{"minutes":1.47,"words":441},"git":{"createdTime":1726124423000,"updatedTime":1726124423000,"contributors":[{"name":"HiCheer-O","email":"chendangdang1998@gmail.com","commits":1}]},"filePathRelative":"运维/nginx/Nginx 安装及配置.md","categoryList":[{"id":"60eec8","sort":10009,"name":"运维"},{"id":"7f7cc2","sort":10016,"name":"nginx"}]}`);export{u as comp,v as data};
